def connect_pg(config):
    """Intenta conectar con la configuración dada y devuelve la conexión."""
    return psycopg2.connect(
        host=config["host"],
        port=config.get("port", 5432),
        dbname=config["dbname"],
        user=config["user"],
        password=config["password"]
    )

def get_local_conn():
    """Devuelve una conexión a la BD local (Postgres)."""
    return connect_pg(PG_LOCAL)

def get_remote_conn():
    """Devuelve una conexión a la BD remota (Postgres). Puede lanzar excepción si no accesible."""
    return connect_pg(PG_REMOTE)
